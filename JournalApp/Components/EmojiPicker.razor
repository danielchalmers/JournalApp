@namespace JournalApp

<EmojiButton OnClick="@(() => _isOpen = !_isOpen)"
             AriaLabel="Choose emoji for day's mood">
    @(SelectedMood ?? DataPoint.Moods[0])
</EmojiButton>

<MudPopover Open="@_isOpen"
            AnchorOrigin="Origin.TopLeft"
            TransformOrigin="Origin.TopLeft"
            Class="emoji-popover">
    <div class="emoji-popover-content">
        @foreach (var mood in DataPoint.Moods)
        {
            <EmojiButton OnClick="@(() => OnMoodClicked(mood))"
                         AriaLabel="@($"Select {mood} mood")">
                @mood
            </EmojiButton>
        }
    </div>
</MudPopover>

<MudOverlay @bind-Visible="@_isOpen"
            AutoClose
            LockScroll="false" />

@code {
    private bool _isOpen;

    [Parameter]
    public string SelectedMood { get; set; }

    [Parameter]
    public EventCallback<string> OnMoodSelected { get; set; }

    private async Task OnMoodClicked(string mood)
    {
        _isOpen = false;
        await OnMoodSelected.InvokeAsync(mood);
    }
}
